# 01. Frontend Architecture and Folder Structure

## Цель документа
Определить идеальную архитектуру frontend-приложения на основе Feature-Sliced Design и Atomic Design для создания чистой, переиспользуемой и поддерживаемой библиотеки компонентов.

## Текущие проблемы архитектуры

### 🔴 Выявленные проблемы:
1. **Смешивание библиотек компонентов**: Использование `@my-forum/ui` и локальных компонентов одновременно
2. **Отсутствие четкого разделения ответственности**: Компоненты в `widgets/` содержат бизнес-логику
3. **Нарушение изоляции**: `features/` компоненты напрямую импортируют UI из `shared/ui/`
4. **Неатомарная структура**: Крупные компоненты не разложены на базовые блоки

### ✅ Предлагаемая архитектура: Feature-Sliced Design + Atomic Design

```
src/
├── app/                    # 🚀 App-wide настройки и провайдеры
│   ├── providers/         # React Context провайдеры
│   ├── styles/           # Глобальные стили
│   └── App.tsx           # Корневой компонент
│
├── processes/             # 🔄 Бизнес-процессы (авторизация, оплата)
│   └── auth/
│       ├── ui/           # Компоненты процесса
│       └── model/        # Бизнес-логика процесса
│
├── pages/                 # 📄 Страницы приложения
│   ├── HomePage/
│   ├── AdminPages/
│   └── EditorPage/
│
├── widgets/               # 🧩 Крупные композитные блоки
│   ├── Header/           # Шапка сайта
│   ├── Sidebar/          # Боковая панель
│   ├── EditorToolbar/    # Панель инструментов редактора
│   └── BlockLibrary/     # Библиотека блоков
│
├── features/              # ⚡ Компоненты с бизнес-логикой
│   ├── CreatePageModal/  # Модальное окно создания страницы
│   ├── ReusableBlocksLibrary/ # Логика работы с библиотекой
│   └── BlockEditors/     # Редакторы для разных типов блоков
│
├── entities/              # 🎯 Бизнес-сущности
│   ├── category/         # Категория
│   │   ├── ui/          # UI компоненты категории
│   │   ├── model/       # Типы и бизнес-логика
│   │   └── api/         # API взаимодействия
│   ├── page/            # Страница
│   └── block/           # Блок контента
│
├── shared/                # 🔧 Переиспользуемые компоненты и утилиты
│   ├── ui/               # 🎨 Базовые UI компоненты (Atomic Design)
│   │   ├── atoms/        # ⚛️ Атомы: Button, Input, Icon
│   │   ├── molecules/    # 🧬 Молекулы: SearchInput, Modal
│   │   └── organisms/    # 🦠 Организмы: Header, Sidebar
│   │
│   ├── lib/              # 🛠️ Утилиты и хелперы
│   │   ├── utils.ts      # Общие утилиты
│   │   ├── constants.ts  # Константы
│   │   └── types.ts      # Общие типы
│   │
│   ├── api/              # 🌐 API клиенты и запросы
│   ├── config/           # ⚙️ Конфигурация приложения
│   └── hooks/            # 🪝 Кастомные React хуки
│
└── blocks/                # 🧱 CMS-специфичные блоки
    ├── core/             # Ядро системы блоков
    ├── atomic/           # Атомарные блоки контента
    └── layout/           # Блоки компоновки
```

## Детальное описание слоев

### 1. Shared/UI: Базовая библиотека компонентов

#### Atoms (Атомы) - простейшие компоненты
```
shared/ui/atoms/
├── Button/           # Базовая кнопка
├── Input/            # Поле ввода
├── Icon/             # Иконка
├── Typography/       # Типографика
├── Card/             # Карточка
├── Spinner/          # Индикатор загрузки
└── Tooltip/          # Всплывающая подсказка
```

#### Molecules (Молекулы) - составные компоненты
```
shared/ui/molecules/
├── SearchInput/      # Поле поиска с иконкой
├── Modal/            # Модальное окно
├── FilterTabs/       # Табы фильтрации
├── ThemeToggle/      # Переключатель темы
└── Notification/     # Уведомление
```

#### Organisms (Организмы) - крупные компоненты
```
shared/ui/organisms/
├── Header/           # Шапка с навигацией
├── Sidebar/          # Боковая панель
├── EmptyState/       # Пустое состояние
└── NotificationContainer/ # Контейнер уведомлений
```

### 2. Entities: Бизнес-сущности

Каждая сущность имеет четкую структуру:
```
entities/[entity-name]/
├── ui/               # UI компоненты сущности
├── model/            # Типы, валидация, бизнес-логика
├── api/              # API методы
└── index.ts         # Публичный API сущности
```

### 3. Features: Компоненты с логикой

```
features/[feature-name]/
├── ui/               # UI компоненты фичи
├── model/            # Бизнес-логика и состояния
├── api/              # Специфичные API вызовы
└── index.ts         # Публичный API фичи
```

### 4. Widgets: Крупные композитные блоки

```
widgets/[widget-name]/
├── ui/               # UI компонент виджета
├── model/            # Локальная логика виджета
└── index.ts         # Экспорт
```

### 5. Blocks: CMS-специфичные блоки

```
blocks/
├── core/             # Ядро системы блоков
│   ├── BlockRenderer/
│   ├── BlockWrapper/
│   └── DropZone/
├── atomic/           # Атомарные блоки контента
│   ├── ButtonBlock/
│   ├── HeadingBlock/
│   └── ImageBlock/
└── layout/           # Блоки компоновки
    ├── ContainerBlock/
    ├── SectionBlock/
    └── ColumnBlock/
```

## Принципы организации компонентов

### 🎯 Принцип единственной ответственности
- **Atoms**: Только рендеринг, без логики
- **Molecules**: Комбинируют atoms, минимальная логика
- **Organisms**: Компонуют molecules, содержат локальную логику
- **Widgets**: Компонуют organisms и features, содержат сложную логику

### 🔄 Принцип зависимости
- Вышестоящие слои могут зависеть от нижестоящих
- Нижестоящие слои НЕ могут зависеть от вышестоящих
- Shared/UI - базовый слой, от которого зависят все

### 📦 Принцип изоляции
- Каждый слой имеет четкие границы
- Импорты только из разрешенных слоев
- Использование index.ts для явного экспорта

## Примеры миграции компонентов

### Пример 1: ContainerSection → blocks/layout/ContainerBlock

**Текущий путь**: `widgets/ContainerSection/index.tsx`
**Проблемы**: Смешивает логику рендеринга с бизнес-логикой получения дочерних блоков

**Новое расположение**: `blocks/layout/ContainerBlock/`
```
blocks/layout/ContainerBlock/
├── ui/
│   ├── ContainerBlock.tsx    # Чистый UI компонент
│   └── ContainerBlockEditor.tsx # Редактор для CMS
├── model/
│   ├── types.ts             # Типы блока
│   └── utils.ts             # Утилиты для работы с контейнерами
└── index.ts
```

### Пример 2: ReusableBlocksLibrary → features/ReusableBlocksLibrary

**Текущий путь**: `features/ReusableBlocksLibrary/index.tsx`
**Проблемы**: Компонент-монстр с 250+ строками

**Рефакторинг**:
```
features/ReusableBlocksLibrary/
├── ui/
│   ├── ReusableBlocksLibraryModal.tsx
│   ├── BlockFilters.tsx
│   └── BlockGrid.tsx
├── model/
│   ├── hooks/
│   │   ├── useBlockFilters.ts
│   │   └── useBlockLibrary.ts
│   └── types.ts
└── index.ts
```

### Пример 3: Header → widgets/Header (без изменений)

**Текущий путь**: `widgets/Header.tsx`
**Статус**: ✅ Хороший компонент, требует минимальных изменений

## План миграции

### Фаза 1: Создание новой структуры (1-2 недели)
1. Создать новую папку `blocks/` для CMS-специфичных компонентов
2. Реструктурировать `shared/ui/` согласно Atomic Design
3. Создать базовые типы и интерфейсы

### Фаза 2: Миграция компонентов (2-3 недели)
1. Перенести атомарные компоненты в `shared/ui/atoms/`
2. Разбить крупные компоненты на более мелкие
3. Создать недостающие базовые блоки

### Фаза 3: Интеграция и тестирование (1-2 недели)
1. Обновить все импорты
2. Провести интеграционное тестирование
3. Оптимизировать производительность

## Заключение

Предлагаемая архитектура решает ключевые проблемы:
- ✅ Четкое разделение ответственности
- ✅ Атомарность и переиспользуемость
- ✅ Масштабируемость для крупных команд
- ✅ Легкость поддержки и рефакторинга
- ✅ Поддержка Drag & Drop через композицию

Следующий шаг: детальный аудит существующих компонентов в Документе 2.
